[tox]
envlist = py311, unit, integration, coverage, performance, format
minversion = 4.11
skip_missing_interpreters = true

[testenv]
description = 运行完整 pytest 套件
deps = -r requirements-dev.txt
passenv = *
setenv =
    PYTHONPATH = {toxinidir}
commands = python -m pytest {posargs}
allowlist_externals =
    python

[testenv:unit]
description = 运行仅包含单元测试的脚本
commands = python tests/tools/run_tests.py --unit {posargs}

[testenv:integration]
description = 运行集成测试
commands = python tests/tools/run_tests.py --integration {posargs}

[testenv:coverage]
description = 生成覆盖率报告
commands = python tests/tools/run_tests.py --coverage {posargs}

[testenv:performance]
description = 运行性能测试
commands = python tests/tools/run_tests.py --performance {posargs}

[testenv:format]
description = 使用 Black 自动格式化代码
skip_install = true
deps = -r requirements-dev.txt
commands = black {posargs:.}

[testenv:format-check]
description = 使用 Black 检查代码格式（不修改文件）
skip_install = true
deps = -r requirements-dev.txt
commands = black --check {posargs:.}

